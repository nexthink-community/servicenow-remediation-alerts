describe("Test for RemediationManager:", function() {
	var remediation;
	var email;
	var body_html = '<html xmlns:v="urn:schemas-microsoft-com:vml" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:w="urn:schemas-microsoft-com:office:word" xmlns:m="http://schemas.microsoft.com/office/2004/12/omml" xmlns="http://www.w3.org/TR/REC-html40"><head>    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">    <meta name="Generator" content="Microsoft Word 15 (filtered medium)">    <!--[if !mso]><style>v\:* {behavior:url(#default#VML);}o\:* {behavior:url(#default#VML);}w\:* {behavior:url(#default#VML);}.shape {behavior:url(#default#VML);}</style><![endif]-->    <style>        <!--        /* Font Definitions */        @font-face {            font-family: Helvetica;            panose-1: 2 11 6 4 2 2 2 2 2 4;        }        @font-face {            font-family: "Cambria Math";            panose-1: 2 4 5 3 5 4 6 3 2 4;        }        @font-face {            font-family: Calibri;            panose-1: 2 15 5 2 2 2 4 3 2 4;        }        /* Style Definitions */        p.MsoNormal,        li.MsoNormal,        div.MsoNormal {            margin: 0cm;            margin-bottom: .0001pt;            font-size: 11.0pt;            font-family: "Calibri", sans-serif;        }        h1 {            mso-style-priority: 9;            mso-style-link: "Heading 1 Char";            mso-margin-top-alt: auto;            margin-right: 0cm;            mso-margin-bottom-alt: auto;            margin-left: 0cm;            font-size: 24.0pt;            font-family: "Calibri", sans-serif;            font-weight: bold;        }        a:link,        span.MsoHyperlink {            mso-style-priority: 99;            color: #0563C1;            text-decoration: underline;        }        a:visited,        span.MsoHyperlinkFollowed {            mso-style-priority: 99;            color: #954F72;            text-decoration: underline;        }        span.EmailStyle17 {            mso-style-type: personal-compose;            font-family: "Calibri", sans-serif;            color: windowtext;        }        span.Heading1Char {            mso-style-name: "Heading 1 Char";            mso-style-priority: 9;            mso-style-link: "Heading 1";            font-family: "Calibri", sans-serif;            font-weight: bold;        }        p.xmsonormal,        li.xmsonormal,        div.xmsonormal {            mso-style-name: x_msonormal;            margin: 0cm;            margin-bottom: .0001pt;            font-size: 11.0pt;            font-family: "Calibri", sans-serif;        }        .MsoChpDefault {            mso-style-type: export-only;            font-family: "Calibri", sans-serif;        }        @page WordSection1 {            size: 612.0pt 792.0pt;            margin: 72.0pt 72.0pt 72.0pt 72.0pt;        }        div.WordSection1 {            page: WordSection1;        }        -->    </style>    <!--[if gte mso 9]><xml><o:shapedefaults v:ext="edit" spidmax="1026" /></xml><![endif]-->    <!--[if gte mso 9]><xml><o:shapelayout v:ext="edit"><o:idmap v:ext="edit" data="1" /></o:shapelayout></xml><![endif]--></head><body lang="EN-US" link="#0563C1" vlink="#954F72">    <div class="WordSection1">        <p><span style="color:black"><o:p>&nbsp;</o:p></span></p>        <h1 style="background:#F8F8F8"><span style="font-size:14.0pt;font-family:&quot;Arial&quot;,sans-serif;color:#333333">bitlocker2- alert</span><span style="color:#212121"><o:p></o:p></span></h1>        <table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0" width="100%" style="width:100.0%;background:#F8F8F8;border-collapse:collapse">            <tbody>                <tr>                    <td width="20%" valign="top" style="width:20.0%;border:solid #CCCCCC 1.0pt;border-right:none;padding:.75pt 12.0pt .75pt 6.0pt;border-image: initial">                        <p class="xmsonormal"><span style="font-size:7.0pt;color:#777777">Source:</span><span style="font-size:7.0pt;color:#212121"><br>Nexthink</span><span style="color:#212121"><o:p></o:p></span></p>                    </td>                    <td width="20%" valign="top" style="width:20.0%;border-top:solid #CCCCCC 1.0pt;border-left:none;border-bottom:solid #CCCCCC 1.0pt;border-right:none;padding:.75pt 12.0pt .75pt 6.0pt">                        <p class="xmsonormal"><span style="font-size:7.0pt;color:#777777">Global alert</span><span style="color:#212121"><o:p></o:p></span></p>                    </td>                    <td width="20%" valign="top" style="width:20.0%;border:solid #CCCCCC 1.0pt;border-left:none;padding:.75pt 12.0pt .75pt 6.0pt;border-image: initial">                        <p class="xmsonormal"><span style="font-size:7.0pt;color:#777777">Period:</span><span style="font-size:7.0pt;color:#212121"><br>from 2017-07-12 10:00:00 to 2017-07-12 11:00:00 [europe/paris]</span><span style="color:#212121"><o:p></o:p></span></p>                    </td>                </tr>            </tbody>        </table>        <p class="xmsonormal" style="background:#F8F8F8"><span style="font-family:&quot;Arial&quot;,sans-serif;color:#333333">&nbsp;</span><span style="color:#212121"><o:p></o:p></span></p>        <table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0" width="100%" style="width:100.0%;background:#F8F8F8;border-collapse:collapse">            <tbody>                <tr>                    <td style="border:solid #395072 1.0pt;background:#172B4A;padding:7.2pt 7.2pt 7.2pt 7.2pt">                        <p class="xmsonormal" align="center" style="text-align:center"><b><span style="font-size:7.0pt;color:white">Name</span></b><span style="color:#212121"><o:p></o:p></span></p>                    </td>                    <td style="border:solid #395072 1.0pt;border-left:none;background:#172B4A;padding:7.2pt 7.2pt 7.2pt 7.2pt;border-image: initial">                        <p class="xmsonormal" align="center" style="text-align:center"><b><span style="font-size:7.0pt;color:white">Device UUID</span></b><span style="color:#212121"><o:p></o:p></span></p>                    </td>                    <td style="border:solid #395072 1.0pt;border-left:none;background:#172B4A;padding:7.2pt 7.2pt 7.2pt 7.2pt;border-image: initial">                        <p class="xmsonormal" align="center" style="text-align:center"><b><span style="font-size:7.0pt;color:white">action:bitlocker2/Output</span></b><span style="color:#212121"><o:p></o:p></span></p>                    </td>                    <td style="border:solid #395072 1.0pt;border-left:none;background:#172B4A;padding:7.2pt 7.2pt 7.2pt 7.2pt;border-image: initial">                        <p class="xmsonormal" align="center" style="text-align:center"><b><span style="font-size:7.0pt;color:white">action:bitlocker2/Target status</span></b><span style="color:#212121"><o:p></o:p></span></p>                    </td>                    <td style="border:solid #395072 1.0pt;border-left:none;background:#172B4A;padding:7.2pt 7.2pt 7.2pt 7.2pt;border-image: initial">                        <p class="xmsonormal" align="center" style="text-align:center"><b><span style="font-size:7.0pt;color:white">action:bitlocker2/Execution status details</span></b><span style="color:#212121"><o:p></o:p></span></p>                    </td>                    <td style="border:solid #395072 1.0pt;border-left:none;background:#172B4A;padding:7.2pt 7.2pt 7.2pt 7.2pt;border-image: initial">                        <p class="xmsonormal" align="center" style="text-align:center"><b><span style="font-size:7.0pt;color:white">action:bitlocker2/Execution status</span></b><span style="color:#212121"><o:p></o:p></span></p>                    </td>                    <td style="border:solid #395072 1.0pt;border-left:none;background:#172B4A;padding:7.2pt 7.2pt 7.2pt 7.2pt;border-image: initial">                        <p class="xmsonormal" align="center" style="text-align:center"><b><span style="font-size:7.0pt;color:white">action:bitlocker2/Number of days since last execution</span></b><span style="color:#212121"><o:p></o:p></span></p>                    </td>                    <td style="border:solid #395072 1.0pt;border-left:none;background:#172B4A;padding:7.2pt 7.2pt 7.2pt 7.2pt;border-image: initial">                        <p class="xmsonormal" align="center" style="text-align:center"><b><span style="font-size:7.0pt;color:white">action:bitlocker2/Last execution time</span></b><span style="color:#212121"><o:p></o:p></span></p>                    </td>                </tr>                <tr>                    <td style="border:solid #D4DFED 1.0pt;border-top:none;background:white;padding:7.2pt 7.2pt 7.2pt 7.2pt;border-image: initial">                        <p class="xmsonormal"><span style="font-size:7.0pt;color:#212121">WIN10-REM</span><span style="color:#212121"><o:p></o:p></span></p>                    </td>                    <td style="border-top:none;border-left:none;border-bottom:solid #D4DFED 1.0pt;border-right:solid #D4DFED 1.0pt;background:white;padding:7.2pt 7.2pt 7.2pt 7.2pt">                        <p class="xmsonormal"><span lang="ES" style="font-size:7.0pt;color:#212121">69C11C42-8B79-FC49-EE49-6296EEA2C7DB</span><span lang="ES" style="color:#212121"><o:p></o:p></span></p>                    </td>                    <td style="border-top:none;border-left:none;border-bottom:solid #D4DFED 1.0pt;border-right:solid #D4DFED 1.0pt;background:white;padding:7.2pt 7.2pt 7.2pt 7.2pt">                    </td>                    <td style="border-top:none;border-left:none;border-bottom:solid #D4DFED 1.0pt;border-right:solid #D4DFED 1.0pt;background:white;padding:7.2pt 7.2pt 7.2pt 7.2pt">                        <p class="xmsonormal"><span style="font-size:7.0pt;color:#212121">executed</span><span style="color:#212121"><o:p></o:p></span></p>                    </td>                    <td style="border-top:none;border-left:none;border-bottom:solid #D4DFED 1.0pt;border-right:solid #D4DFED 1.0pt;background:white;padding:7.2pt 7.2pt 7.2pt 7.2pt">                        <p class="xmsonormal"><span style="font-size:7.0pt;color:#212121">Cannot execute PowerShell Script: signature is invalid or not trusted</span><span style="color:#212121"><o:p></o:p></span></p>                    </td>                    <td style="border-top:none;border-left:none;border-bottom:solid #D4DFED 1.0pt;border-right:solid #D4DFED 1.0pt;background:white;padding:7.2pt 7.2pt 7.2pt 7.2pt">                        <p class="xmsonormal"><span style="font-size:7.0pt;color:#212121">failure</span><span style="color:#212121"><o:p></o:p></span></p>                    </td>                    <td style="border-top:none;border-left:none;border-bottom:solid #D4DFED 1.0pt;border-right:solid #D4DFED 1.0pt;background:white;padding:7.2pt 7.2pt 7.2pt 7.2pt">                        <p class="xmsonormal"><span style="font-size:7.0pt;color:#212121">0</span><span style="color:#212121"><o:p></o:p></span></p>                    </td>                    <td style="border-top:none;border-left:none;border-bottom:solid #D4DFED 1.0pt;border-right:solid #D4DFED 1.0pt;background:white;padding:7.2pt 7.2pt 7.2pt 7.2pt">                        <p class="xmsonormal"><span style="font-size:7.0pt;color:#212121">12.07.2017 @ 10:25:39</span><span style="color:#212121"><o:p></o:p></span></p>                    </td>                </tr>                <tr>                    <td style="border:solid #D4DFED 1.0pt;border-top:none;background:#E7EDF5;padding:7.2pt 7.2pt 7.2pt 7.2pt;border-image: initial">                        <p class="xmsonormal"><span style="font-size:7.0pt;color:#212121">WIN10-REM2</span><span style="color:#212121"><o:p></o:p></span></p>                    </td>                    <td style="border-top:none;border-left:none;border-bottom:solid #D4DFED 1.0pt;border-right:solid #D4DFED 1.0pt;background:#E7EDF5;padding:7.2pt 7.2pt 7.2pt 7.2pt">                        <p class="xmsonormal"><span style="font-size:7.0pt;color:#212121">EE3F1C42-7693-95B0-AB51-78D036033078</span><span style="color:#212121"><o:p></o:p></span></p>                    </td>                    <td style="border-top:none;border-left:none;border-bottom:solid #D4DFED 1.0pt;border-right:solid #D4DFED 1.0pt;background:#E7EDF5;padding:7.2pt 7.2pt 7.2pt 7.2pt">                        <p class="xmsonormal"><span style="font-size:7.0pt;color:#212121">Protection Off, Fully Decrypted</span><span style="color:#212121"><o:p></o:p></span></p>                    </td>                    <td style="border-top:none;border-left:none;border-bottom:solid #D4DFED 1.0pt;border-right:solid #D4DFED 1.0pt;background:#E7EDF5;padding:7.2pt 7.2pt 7.2pt 7.2pt">                        <p class="xmsonormal"><span style="font-size:7.0pt;color:#212121">executed</span><span style="color:#212121"><o:p></o:p></span></p>                    </td>                    <td style="border-top:none;border-left:none;border-bottom:solid #D4DFED 1.0pt;border-right:solid #D4DFED 1.0pt;background:#E7EDF5;padding:7.2pt 7.2pt 7.2pt 7.2pt">                        <p class="xmsonormal"><span style="font-size:7.0pt;color:#212121">PowerShell exited with code 0</span><span style="color:#212121"><o:p></o:p></span></p>                    </td>                    <td style="border-top:none;border-left:none;border-bottom:solid #D4DFED 1.0pt;border-right:solid #D4DFED 1.0pt;background:#E7EDF5;padding:7.2pt 7.2pt 7.2pt 7.2pt">                        <p class="xmsonormal"><span style="font-size:7.0pt;color:#212121">success</span><span style="color:#212121"><o:p></o:p></span></p>                    </td>                    <td style="border-top:none;border-left:none;border-bottom:solid #D4DFED 1.0pt;border-right:solid #D4DFED 1.0pt;background:#E7EDF5;padding:7.2pt 7.2pt 7.2pt 7.2pt">                        <p class="xmsonormal"><span style="font-size:7.0pt;color:#212121">0</span><span style="color:#212121"><o:p></o:p></span></p>                    </td>                    <td style="border-top:none;border-left:none;border-bottom:solid #D4DFED 1.0pt;border-right:solid #D4DFED 1.0pt;background:#E7EDF5;padding:7.2pt 7.2pt 7.2pt 7.2pt">                        <p class="xmsonormal"><span style="font-size:7.0pt;color:#212121">12.07.2017 @ 10:25:40</span><span style="color:#212121"><o:p></o:p></span></p>                    </td>                </tr>            </tbody>        </table>        <p class="xmsonormal" style="background:#F8F8F8"><span style="color:#212121">&nbsp;<o:p></o:p></span></p>        <p class="MsoNormal" style="margin-bottom:12.0pt">            <o:p>&nbsp;</o:p>        </p>        <p class="MsoNormal">            <o:p>&nbsp;</o:p>        </p>        <p class="MsoNormal">            <o:p>&nbsp;</o:p>        </p>        <p class="MsoNormal">            <o:p>&nbsp;</o:p>        </p>        <p class="MsoNormal"><span style="font-size:10.0pt;font-family:&quot;Helvetica&quot;,sans-serif;color:#1F497D">Marcos Fermín Lobo<o:p></o:p></span></p>        <p class="MsoNormal"><span style="font-size:10.0pt;font-family:&quot;Helvetica&quot;,sans-serif;color:#1F497D">Integration Engineer | Nexthink<o:p></o:p></span></p>        <p class="MsoNormal"><span style="font-size:1.0pt;font-family:&quot;Helvetica&quot;,sans-serif;color:#1F497D"><o:p>&nbsp;</o:p></span></p>        <p class="MsoNormal"><span lang="ES" style="font-size:8.5pt;font-family:&quot;Helvetica&quot;,sans-serif;color:#1F497D">Paseo de la Castellana 8 | Madrid | 28046 | Spain<o:p></o:p></span></p>        <p class="MsoNormal"><span lang="ES" style="font-size:2.0pt;font-family:&quot;Helvetica&quot;,sans-serif;color:#1F497D"><o:p>&nbsp;</o:p></span></p>        <p class="MsoNormal"><span style="color:black"><img width="246" height="31" style="width:2.5583in;height:.325in" id="Picture_x0020_1" src="/sys_attachment.do?sys_id=dd0d22c84fa00300bfef0ab18110c756" alt="Nexthink-logo-for-white-background-high-res-tagline-right"></span>            <o:p></o:p>        </p>        <p class="MsoNormal">            <o:p>&nbsp;</o:p>        </p>    </div></body></html>';
	
	beforeEach(function() {
		remediation = new x_nexsa_imc.RemediationManager();
		email = {body_html: body_html};
    });
	
	it("Check device name list from HTML table", function() {
		var exp = ["WIN10-REM", "WIN10-REM2"];
		var ret = remediation._getDeviceListFromEmail(email);
		expect(ret).toEqual(exp);
	});
});
	
jasmine.getEnv().execute();